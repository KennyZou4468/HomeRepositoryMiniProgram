<!-- pages/index/index.wxml -->
<view class="container {{darkMode ? 'theme-dark' : ''}} {{elderMode ? 'elder-mode' : ''}} page-enter">
  <!-- åˆ†ç±»åˆ‡æ¢ Bar -->
  <view class="category-bar">
    <view class="category-item {{currentTab === 0 ? 'active' : ''}}" data-tab="{{0}}" bindtap="onTabChange">
      <text class="category-text">å¸¸è§„ç‰©å“</text>
      <view class="category-indicator" wx:if="{{currentTab === 0}}"></view>
    </view>
    <view class="category-item {{currentTab === 1 ? 'active' : ''}}" data-tab="{{1}}" bindtap="onTabChange">
      <text class="category-text">ç‰¹æ®Šç‰©å“</text>
      <view class="category-indicator" wx:if="{{currentTab === 1}}"></view>
    </view>
  </view>
  <!-- åˆ†å‰²çº¿ -->
  <view class="divider"></view>
  
  <!-- æœç´¢æ¡† -->
  <view class="search-box">
    <text class="search-emoji">ğŸ”</text>
    <input class="search-input" placeholder="æœç´¢ç‰©å“ã€ä½ç½®æˆ–å¤‡æ³¨..." value="{{searchText}}" bindinput="onSearchInput" />
    <view wx:if="{{searchText}}" class="clear-btn" bindtap="onClearSearch">
      <text>âœ•</text>
    </view>
  </view>
  
  <!-- ç‰©å“åˆ—è¡¨ -->
  <view class="item-list" wx:if="{{(currentTab === 0 && normalItems.length > 0) || (currentTab === 1 && specialItems.length > 0)}}">
    <!-- å¸¸è§„ç‰©å“ -->
    <view wx:if="{{currentTab === 0}}">
      <!-- åˆ—è¡¨é¡¹ - å¡ç‰‡å¼ï¼Œé€æ¡æ·¡å…¥åŠ¨ç”» -->
      <view class="item-card card-animate" style="animation-delay: {{index * 50}}ms;" wx:for="{{normalItems}}" wx:key="id" data-id="{{item.id}}" bindtap="onItemTap">
        <view class="card-main">
          <view class="card-icon">ğŸ“¦</view>
          <view class="card-info">
            <text class="card-name">{{item.name}}</text>
            <view class="card-location">
              <text class="location-icon">ğŸ“</text>
              <text class="location-text">{{item.location}}</text>
            </view>
          </view>
          <view class="card-count-wrapper">
            <view class="card-count {{item.count <= 2 ? 'low-count' : ''}}">
              {{item.count}}{{item.unit ? item.unit : ''}}
            </view>
            <text class="low-count-tip" wx:if="{{item.count <= 2}}">å¿«ç”¨å®Œå•¦ï½</text>
          </view>
        </view>
        <view class="card-arrow">â€º</view>
      </view>
    </view>
    
    <!-- ç‰¹æ®Šç‰©å“ï¼ˆæœ‰ä½¿ç”¨æœŸé™ï¼‰ -->
    <view wx:if="{{currentTab === 1}}">
      <!-- åˆ—è¡¨é¡¹ - å¡ç‰‡å¼ï¼Œé€æ¡æ·¡å…¥åŠ¨ç”» -->
      <view class="item-card card-animate {{item.expireStatusClass}}" style="animation-delay: {{index * 50}}ms;" wx:for="{{specialItems}}" wx:key="id" data-id="{{item.id}}" bindtap="onItemTap">
        <view class="card-main">
          <view class="card-icon">â°</view>
          <view class="card-info">
            <text class="card-name">{{item.name}}</text>
            <view class="card-location">
              <text class="location-icon">ğŸ“</text>
              <text class="location-text">{{item.location}}</text>
            </view>
            <!-- åˆ°æœŸçŠ¶æ€ -->
            <view class="expire-status {{item.expireStatusClass}}" wx:if="{{item.expireStatusText}}">
              <text>{{item.expireStatusText}}</text>
            </view>
          </view>
          <view class="card-count-wrapper">
            <view class="card-count {{item.count <= 2 ? 'low-count' : ''}}">
              {{item.count}}{{item.unit ? item.unit : ''}}
            </view>
            <text class="low-count-tip" wx:if="{{item.count <= 2}}">å¿«ç”¨å®Œå•¦ï½</text>
          </view>
        </view>
        <view class="card-arrow">â€º</view>
      </view>
    </view>
  </view>
  <!-- æœç´¢æ— ç»“æœ -->
  <view class="no-result" wx:if="{{((currentTab === 0 && normalItems.length === 0) || (currentTab === 1 && specialItems.length === 0)) && searchText && items.length > 0}}">
    <text class="no-result-emoji">ğŸ¤”</text>
    <text class="no-result-text">æ²¡æœ‰æ‰¾åˆ°ã€Œ{{searchText}}ã€ç›¸å…³çš„ç‰©å“</text>
    <text class="no-result-hint">æ¢ä¸ªå…³é”®è¯è¯•è¯•ï¼Ÿ</text>
  </view>
  <!-- ç©ºçŠ¶æ€ -->
  <view class="empty-state" wx:if="{{((currentTab === 0 && normalItems.length === 0) || (currentTab === 1 && specialItems.length === 0)) && !searchText}}">
    <text class="empty-icon">{{currentTab === 0 ? 'ğŸ“¦' : 'â°'}}</text>
    <text class="empty-title">{{currentTab === 0 ? 'è¿˜æ²¡æœ‰å¸¸è§„ç‰©å“å“¦ï½' : 'è¿˜æ²¡æœ‰ç‰¹æ®Šç‰©å“å“¦ï½'}}</text>
    <text class="empty-subtitle">{{currentTab === 0 ? 'ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®æ·»åŠ ç¬¬ä¸€ä¸ªç‰©å“å§' : 'æ·»åŠ æœ‰ä½¿ç”¨æœŸé™çš„ç‰©å“ï¼ŒåŠæ—¶ç®¡ç†ä¿è´¨æœŸ'}}</text>
  </view>
  <!-- æ–°å¢ç‰©å“æŒ‰é’® -->
  <view class="add-button" bindtap="onAddItem">
    <text class="add-icon">â•</text>
    <text class="add-text">æ·»åŠ ç‰©å“</text>
  </view>
</view>